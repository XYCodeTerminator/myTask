webpackJsonp([1],{"+cgv":function(e,t){},"3f40":function(e,t){},"4qOc":function(e,t){},"7zck":function(e,t){},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s("7+uW"),r={render:function(){var e=this.$createElement,t=this._self._c||e;return t("v-app",[t("router-view")],1)},staticRenderFns:[]},i=s("VU/8")({data:function(){return{}},name:"App"},r,!1,null,null,null).exports,n=s("/ocq"),a={data:function(){return{clipped:!1,drawer:!0,fixed:!1,sysDisplay:!1,headIcon:"",systemItems:[{display:!1,icon:"fa fa-users",title:"用户管理",href:"/main/users"},{display:!1,icon:"face",title:"角色管理",href:"/main/roles"},{display:!1,icon:"fa fa-book",title:"图书管理",href:"/main/bookManage"},{display:!1,icon:"fa fa-edit",title:"图书登记",href:"/main/bookDetailEdit"}],accountSettingItems:[{display:!0,icon:"fa fa-book",title:"图书一览",href:"/main/bookDisplay"},{display:!0,icon:"favorite",title:"我的收藏",href:"/main/myCollectBooks"},{display:!0,icon:"star",title:"我的订阅",href:"/main/mySubscribeBooks"},{display:!0,icon:"fa fa-sign-out",title:"注销",href:"/"}],miniVariant:!1,right:!0,rightDrawer:!1,title:"图书管理系统",currentUser:{}}},name:"App",created:function(){var e=this;this.$http.get("/verify").then(function(t){if(t.data.isLogin)if(e.currentUser=t.data.user,"superAdmin"==t.data.user.role.roleName){e.sysDisplay=!0,e.headIcon="superAdmin.png";for(var s=0;s<e.systemItems.length;s++)e.systemItems[s].display=!0}else"admin"==t.data.user.role.roleName?(e.sysDisplay=!0,e.headIcon="admin.png",e.systemItems[2].display=!0,e.systemItems[3].display=!0):e.headIcon="user.png";else e.$router.push("/")}).catch(function(e){console.log(e)})},methods:{setSession:function(e){var t=this;"注销"==e.title?this.$http.get("/clearSession").then(function(e){t.$router.push("/")}).catch(function(e){console.log(e)}):"图书登记"==e.title&&this.$store.commit("clearItem")}}},l={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-app",[s("v-navigation-drawer",{attrs:{persistent:"","mini-variant":e.miniVariant,clipped:e.clipped,"enable-resize-watcher":"",fixed:"",app:""},on:{"update:miniVariant":function(t){e.miniVariant=t}},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[s("v-toolbar",{staticClass:"transparent",attrs:{flat:""}},[s("v-list",{staticClass:"pa-0"},[s("v-list-tile",{attrs:{avatar:""}},[s("v-list-tile-avatar",[s("img",{attrs:{src:"static/images/"+e.headIcon}})]),e._v(" "),s("v-list-tile-content",[s("v-list-tile-title",[e._v(e._s(this.currentUser.username))])],1),e._v(" "),s("v-list-tile-action",[s("v-btn",{attrs:{icon:""},nativeOn:{click:function(t){t.stopPropagation(),e.miniVariant=!e.miniVariant}}},[s("v-icon",[e._v("chevron_left")])],1)],1)],1)],1)],1),e._v(" "),s("v-list",[e.sysDisplay?s("v-divider"):e._e(),e._v(" "),e.sysDisplay?s("v-subheader",[e._v("系统管理")]):e._e(),e._v(" "),e._l(e.systemItems,function(t,o){return t.display?s("v-list-tile",{key:"systemItem-"+o,attrs:{to:t.href},on:{click:function(s){e.setSession(t)}}},[s("v-list-tile-action",[s("v-icon",{domProps:{innerHTML:e._s(t.icon)}})],1),e._v(" "),s("v-list-tile-content",[s("v-list-tile-title",{domProps:{textContent:e._s(t.title)}})],1)],1):e._e()}),e._v(" "),s("v-divider"),e._v(" "),s("v-subheader",[e._v("账户设置")]),e._v(" "),e._l(e.accountSettingItems,function(t,o){return s("v-list-tile",{key:"accountSettingItem-"+o,attrs:{to:t.href},on:{click:function(s){e.setSession(t)}}},[s("v-list-tile-action",[s("v-icon",{domProps:{innerHTML:e._s(t.icon)}})],1),e._v(" "),s("v-list-tile-content",[s("v-list-tile-title",{domProps:{textContent:e._s(t.title)}})],1)],1)})],2)],1),e._v(" "),s("v-toolbar",{attrs:{app:"","clipped-left":e.clipped}},[s("v-toolbar-side-icon",{on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}}),e._v(" "),s("v-toolbar-title",{domProps:{textContent:e._s(e.title)}})],1),e._v(" "),s("v-content",[s("router-view")],1),e._v(" "),s("v-navigation-drawer",{attrs:{temporary:"",right:e.right,fixed:"",app:""},model:{value:e.rightDrawer,callback:function(t){e.rightDrawer=t},expression:"rightDrawer"}}),e._v(" "),s("v-footer",{attrs:{fixed:e.fixed,app:""}},[s("span",[e._v("© 2018")])])],1)},staticRenderFns:[]},c=s("VU/8")(a,l,!1,null,null,null).exports,u={data:function(){return{drawer:null,valid:!1,errorAlert:!1,showProgress:!1,loginMsg:"",username:"",usernameRules:[function(e){return!!e||"用户名不能为空！"}],password:"",passwordRules:[function(e){return!!e||"密码不能为空!"}],hidePwd:!0}},props:{source:String},beforeCreate:function(){var e=this;this.$http.get("/verify").then(function(t){t.data.isLogin&&e.$router.push("/main/bookDisplay")}).catch(function(e){console.log(e)})},methods:{login:function(){var e=this;this.valid=!1,this.$refs.loginForm.validate()&&(this.showProgress=!0,this.$http.post("/login",{username:this.username,password:this.password}).then(function(t){e.showProgress=!1,t.data.isLogin?e.$router.push("/main/bookDisplay"):(e.errorAlert=!0,e.loginMsg=t.data.msg,e.valid=!0)}).catch(function(t){console.log(t),e.showProgress=!1}))}}},d={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-app",{attrs:{id:"inspire"}},[s("v-content",[s("v-container",{attrs:{fluid:"","fill-height":""}},[s("v-layout",{attrs:{"align-center":"","justify-center":""}},[s("v-flex",{attrs:{xs12:"",sm8:"",md4:""}},[s("v-card",{staticClass:"elevation-12"},[s("v-toolbar",{attrs:{dark:"",color:"primary"}},[s("v-toolbar-title",[e._v("图书管理系统")]),e._v(" "),s("v-spacer")],1),e._v(" "),s("v-card-text",[s("v-form",{ref:"loginForm",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[s("v-text-field",{attrs:{"prepend-icon":"person",name:"login",label:"用户名",type:"text",rules:e.usernameRules},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),e._v(" "),s("v-text-field",{attrs:{"prepend-icon":"lock",name:"password",label:"密码",id:"password","append-icon":e.hidePwd?"visibility_off":"visibility","append-icon-cb":function(){return e.hidePwd=!e.hidePwd},type:e.hidePwd?"password":"text",rules:e.passwordRules},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),e._v(" "),s("v-alert",{attrs:{type:"error",transition:"scale-transition",dismissible:""},model:{value:e.errorAlert,callback:function(t){e.errorAlert=t},expression:"errorAlert"}},[e._v("\n                "+e._s(e.loginMsg)+"\n              ")])],1),e._v(" "),s("v-card-actions",[s("v-container",{attrs:{"grid-list-md":"","text-xs-center":""}},[s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",{attrs:{xs10:"",sm10:"",md10:"","offset-xs1":""}},[s("v-btn",{attrs:{block:"",color:"primary",disabled:!e.valid},on:{click:e.login}},[e._v("登录")])],1),e._v(" "),s("v-flex",{attrs:{xs10:"",sm10:"",md10:"","offset-xs1":""}},[s("v-btn",{attrs:{block:"",flat:"",small:"",color:"error",to:"/register"}},[e._v("没有账号注册？")])],1)],1)],1)],1),e._v(" "),s("v-progress-linear",{attrs:{indeterminate:!0,active:e.showProgress}})],1)],1)],1)],1)],1)],1)},staticRenderFns:[]},v=s("VU/8")(u,d,!1,null,null,null).exports,m={data:function(){return{drawer:null,valid:!1,loading:!1,errorAlert:!1,successAlert:!1,registerMsg:"",username:"",usernameRules:[function(e){return!!e||"用户名不能为空！"},function(e){return e&&e.length<=13||"用户名不能超过13个字！"}],password:"",passwordRules:[function(e){return!!e||"密码不能为空！"}],confirmPassword:"",confirmPasswordRules:[function(e){return!!e||"密码不能为空！"},function(e){return e==password.value||"两次输入的密码不一致！"}],hidePwd:!0,hideConfirmPwd:!0,phone:"",phoneRules:[function(e){return!!e||"电话不能为空"},function(e){return/^1\d{10}$/.test(e)||"手机号不否和规则！"}]}},props:{source:String},methods:{register:function(){var e=this;this.valid=!1,this.loading=!0,this.$refs.registerForm.validate()&&this.$http.post("/register",{username:this.username,password:this.password,phone:this.phone,role:{roleName:"user",roleDescribe:"普通用户"}}).then(function(t){console.log(t.data),t.data.isRegister?(e.successAlert=!0,e.registerMsg=t.data.msg,setTimeout(function(){e.successAlert=!1,e.$router.push("/")},2e3)):(e.errorAlert=!0,e.loading=!1,e.valid=!0,e.registerMsg=t.data.msg)})}}},h={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-app",{attrs:{id:"inspire"}},[s("v-content",[s("v-container",{attrs:{fluid:"","fill-height":""}},[s("v-layout",{attrs:{"align-center":"","justify-center":""}},[s("v-flex",{attrs:{xs12:"",sm8:"",md4:""}},[s("v-card",{staticClass:"elevation-12"},[s("v-toolbar",{attrs:{dark:"",color:"primary"}},[s("v-toolbar-title",[e._v("图书管理系统")]),e._v(" "),s("v-spacer")],1),e._v(" "),s("v-card-text",[s("v-form",{ref:"registerForm",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[s("v-text-field",{attrs:{"prepend-icon":"person",name:"login",label:"用户名",type:"text",rules:e.usernameRules,counter:13},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),e._v(" "),s("v-text-field",{attrs:{"prepend-icon":"lock",name:"password",label:"密码",id:"password","append-icon":e.hidePwd?"visibility_off":"visibility","append-icon-cb":function(){return e.hidePwd=!e.hidePwd},type:e.hidePwd?"password":"text",rules:e.passwordRules},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),e._v(" "),s("v-text-field",{attrs:{"prepend-icon":"lock",name:"confirmPassword",label:"确认密码",id:"confirmPassword","append-icon":e.hideConfirmPwd?"visibility_off":"visibility","append-icon-cb":function(){return e.hideConfirmPwd=!e.hideConfirmPwd},type:e.hideConfirmPwd?"password":"text",rules:e.confirmPasswordRules},model:{value:e.confirmPassword,callback:function(t){e.confirmPassword=t},expression:"confirmPassword"}}),e._v(" "),s("v-text-field",{attrs:{"prepend-icon":"phone",name:"phone",label:"手机号",id:"phone",rules:e.phoneRules},model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}})],1),e._v(" "),s("v-alert",{attrs:{type:"error",transition:"scale-transition",dismissible:""},model:{value:e.errorAlert,callback:function(t){e.errorAlert=t},expression:"errorAlert"}},[e._v("\n                "+e._s(e.registerMsg)+"\n              ")]),e._v(" "),s("v-alert",{attrs:{value:e.successAlert,type:"success",transition:"scale-transition"}},[e._v("\n                "+e._s(e.registerMsg)+"\n              ")])],1),e._v(" "),s("v-card-actions",[s("v-container",{attrs:{"grid-list-md":"","text-xs-center":""}},[s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",{attrs:{xs10:"",sm10:"",md10:"","offset-xs1":""}},[s("v-btn",{attrs:{block:"",color:"primary",disabled:!e.valid,loading:e.loading},on:{click:e.register}},[e._v("注册")])],1),e._v(" "),s("v-flex",{attrs:{xs10:"",sm10:"",md10:"","offset-xs1":""}},[s("v-btn",{attrs:{block:"",flat:"",small:"",color:"error",to:"/"}},[e._v("已有账号登录？")])],1)],1)],1)],1)],1)],1)],1)],1)],1)],1)},staticRenderFns:[]},f=s("VU/8")(m,h,!1,null,null,null).exports,p=s("woOf"),b=s.n(p),g={data:function(){return{errorAlert:!1,errorMsg:"",display:!1,dialog:!1,search:"",pageText:"每页显示行数",pageItems:[15,25,35,{text:"所有",value:-1}],headers:[{text:"用户名",value:"username",align:"center"},{text:"密码",value:"password",align:"center"},{text:"电话",value:"phone",align:"center"},{text:"角色名称",value:"roleName",align:"center"},{text:"操作",value:"operation",sortable:!1,align:"center"}],items:[],roles:[],editedIndex:-1,phoneRules:[function(e){return!!e||"电话不能为空"},function(e){return/^1\d{10}$/.test(e)||"手机号不否和规则！"}],editedItem:{username:"",password:"",phone:"",role:{roleName:"",roleDescribe:""}},defaultItem:{username:"",password:"",phone:"",role:{roleName:"",roleDescribe:""}}}},computed:{formTitle:function(){return-1===this.editedIndex?"新建用户":"编辑用户"}},watch:{dialog:function(e){e||this.close()}},beforeCreate:function(){},created:function(){var e=this;this.$http.get("/verify").then(function(t){"superAdmin"!=t.data.user.role.roleName?(e.errorAlert=!0,e.errorMsg="权限不足，请联系超级管理员！！！",setTimeout(function(){e.errorAlert=!1,e.$router.push("/main/bookDisplay")},2e3)):(e.display=!0,e.fetchData())}).catch(function(e){console.log(e)})},methods:{fetchData:function(){var e=this;this.$http.get("/getUsers").then(function(t){t.data.getUsers?e.items=t.data.users:(e.errorAlert=!0,e.errorMsg=t.data.msg,setTimeout(function(){e.errorAlert=!1},2e3))}).catch(function(e){console.log(e)}),this.$http.get("/getRoles").then(function(t){t.data.getRoles?e.roles=t.data.roles:(e.errorAlert=!0,e.errorMsg=t.data.msg,setTimeout(function(){e.errorAlert=!1},2e3))}).catch(function(e){console.log(e)})},editItem:function(e){this.editedIndex=this.items.indexOf(e),this.editedItem=b()({},e),this.dialog=!0},deleteItem:function(e){var t=this,s=this.items.indexOf(e);confirm("确定要删除此用户吗？")&&this.$http.post("/deleteUser",e).then(function(e){e.data.deleteUser?t.items.splice(s,1):(t.errorAlert=!0,t.errorMsg=e.data.msg,setTimeout(function(){t.errorAlert=!1},2e3))}).catch(function(e){console.log(e)})},close:function(){var e=this;this.dialog=!1,setTimeout(function(){e.editedItem=b()({},e.defaultItem),e.editedIndex=-1},300)},save:function(){var e=this;this.editedIndex>-1?this.$http.post("/updateUser",{originalUser:this.items[this.editedIndex],modifiedUser:this.editedItem}).then(function(t){t.data.updateUser?b()(e.items[e.editedIndex],e.editedItem):(e.errorAlert=!0,e.errorMsg=t.data.msg,setTimeout(function(){e.errorAlert=!1},2e3))}).catch(function(e){console.log(e)}):this.$http.post("/addUser",this.editedItem).then(function(t){t.data.addUser?e.items.push(e.editedItem):(e.errorAlert=!0,e.errorMsg=t.data.msg,setTimeout(function(){e.errorAlert=!1},2e3))}).catch(function(e){console.log(e)}),this.close()},addUser:function(){this.dialog=!0}}},_={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("v-alert",{attrs:{type:"error",transition:"scale-transition",dismissible:""},model:{value:e.errorAlert,callback:function(t){e.errorAlert=t},expression:"errorAlert"}},[e._v("\n    "+e._s(e.errorMsg)+"\n  ")]),e._v(" "),s("v-dialog",{attrs:{"max-width":"600px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[s("v-card",[s("v-card-title",[s("span",{staticClass:"headline"},[e._v(e._s(e.formTitle))])]),e._v(" "),s("v-card-text",[s("v-container",{attrs:{"grid-list-md":""}},[s("v-layout",{attrs:{wrap:""}},[s("v-flex",{attrs:{xs12:"",sm6:"",md4:""}},[s("v-text-field",{attrs:{label:"用户名"},model:{value:e.editedItem.username,callback:function(t){e.$set(e.editedItem,"username",t)},expression:"editedItem.username"}})],1),e._v(" "),s("v-flex",{attrs:{xs12:"",sm6:"",md4:""}},[s("v-text-field",{attrs:{label:"密码"},model:{value:e.editedItem.password,callback:function(t){e.$set(e.editedItem,"password",t)},expression:"editedItem.password"}})],1),e._v(" "),s("v-flex",{attrs:{xs12:"",sm6:"",md4:""}},[s("v-text-field",{attrs:{name:"phone",label:"手机号",id:"phone",rules:e.phoneRules},model:{value:e.editedItem.phone,callback:function(t){e.$set(e.editedItem,"phone",t)},expression:"editedItem.phone"}})],1),e._v(" "),s("v-flex",{attrs:{xs12:"",sm6:"",md6:""}},[s("v-select",{attrs:{label:"选择角色",items:e.roles,"item-text":"roleName","item-value":"roleDescribe","single-line":"","prepend-icon":"face","return-object":""},model:{value:e.editedItem.role,callback:function(t){e.$set(e.editedItem,"role",t)},expression:"editedItem.role"}})],1)],1)],1)],1),e._v(" "),s("v-card-actions",[s("v-spacer"),e._v(" "),s("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(t){return e.close(t)}}},[e._v("取消")]),e._v(" "),s("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(t){return e.save(t)}}},[e._v("确定")])],1)],1)],1),e._v(" "),e.display?s("v-card",[s("v-card-title",[s("b",{staticStyle:{"font-size":"18px"}},[e._v("用户管理")]),e._v(" "),s("v-btn",{attrs:{icon:""},on:{click:e.addUser}},[s("v-icon",{attrs:{medium:""}},[e._v("person_add")])],1),e._v(" "),s("v-spacer"),e._v(" "),s("v-text-field",{attrs:{"append-icon":"search",label:"搜索","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),s("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.items,search:e.search,"rows-per-page-text":e.pageText,"rows-per-page-items":e.pageItems},scopedSlots:e._u([{key:"items",fn:function(t){return[s("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.username))]),e._v(" "),s("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.password))]),e._v(" "),s("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.phone))]),e._v(" "),s("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.role.roleName))]),e._v(" "),s("td",{staticClass:"justify-center layout px-0"},[s("v-btn",{staticClass:"mx-0",attrs:{icon:""},on:{click:function(s){e.editItem(t.item)}}},[s("v-icon",{attrs:{color:"teal"}},[e._v("edit")])],1),e._v(" "),s("v-btn",{staticClass:"mx-0",attrs:{icon:""},on:{click:function(s){e.deleteItem(t.item)}}},[s("v-icon",{attrs:{color:"pink"}},[e._v("delete")])],1)],1)]}}])},[s("v-alert",{attrs:{slot:"no-results",value:!0,color:"error",icon:"warning"},slot:"no-results"},[e._v("\n        没有查询到"+e._s(e.search)+"\n      ")])],1)],1):e._e()],1)},staticRenderFns:[]},x=s("VU/8")(g,_,!1,null,null,null).exports,k={data:function(){return{errorAlert:!1,errorMsg:"",display:!1,dialog:!1,search:"",pageText:"每页显示行数",pageItems:[15,25,35,{text:"所有",value:-1}],headers:[{text:"角色名称",value:"roleName",align:"center"},{text:"角色描述",value:"roleDescribe",align:"center"},{text:"操作",value:"operation",sortable:!1,align:"center"}],items:[],editedIndex:-1,editedItem:{roleName:"",roleDescribe:""},defaultItem:{roleName:"",roleDescribe:""}}},computed:{formTitle:function(){return-1===this.editedIndex?"新建角色":"编辑角色"}},watch:{dialog:function(e){e||this.close()}},created:function(){var e=this;this.$http.get("/verify").then(function(t){"superAdmin"!=t.data.user.role.roleName?(e.errorAlert=!0,e.errorMsg="权限不足，请联系超级管理员！！！",setTimeout(function(){e.errorAlert=!1,e.$router.push("/main/bookDisplay")},2e3)):(e.display=!0,e.fetchData())}).catch(function(e){console.log(e)})},methods:{fetchData:function(){var e=this;this.$http.get("/getRoles").then(function(t){t.data.getRoles&&(e.items=t.data.roles)}).catch(function(e){console.log(e)})},editItem:function(e){this.editedIndex=this.items.indexOf(e),this.editedItem=b()({},e),this.dialog=!0},deleteItem:function(e){var t=this,s=this.items.indexOf(e);confirm("确定要删除此角色吗？")&&this.$http.post("/deleteRole",e).then(function(e){e.data.deleteRole?t.items.splice(s,1):(t.errorAlert=!0,t.errorMsg=e.data.msg,setTimeout(function(){t.errorAlert=!1},2e3))}).catch(function(e){console.log(e)})},close:function(){var e=this;this.dialog=!1,setTimeout(function(){e.editedItem=b()({},e.defaultItem),e.editedIndex=-1},300)},save:function(){var e=this;this.editedIndex>-1?this.$http.post("/updateRole",{originalRole:this.items[this.editedIndex],modifiedRole:this.editedItem}).then(function(t){t.data.updateRole?b()(e.items[e.editedIndex],e.editedItem):(e.errorAlert=!0,e.errorMsg=t.data.msg,setTimeout(function(){e.errorAlert=!1},2e3))}).catch(function(e){console.log(e)}):this.$http.post("/addRole",this.editedItem).then(function(t){t.data.addRole?e.items.push(e.editedItem):(e.errorAlert=!0,e.errorMsg=t.data.msg,setTimeout(function(){e.errorAlert=!1},2e3))}).catch(function(e){console.log(e)}),this.close()},addRole:function(){this.dialog=!0}}},y={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("v-alert",{attrs:{type:"error",transition:"scale-transition",dismissible:""},model:{value:e.errorAlert,callback:function(t){e.errorAlert=t},expression:"errorAlert"}},[e._v("\n    "+e._s(e.errorMsg)+"\n  ")]),e._v(" "),s("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[s("v-card",[s("v-card-title",[s("span",{staticClass:"headline"},[e._v(e._s(e.formTitle))])]),e._v(" "),s("v-card-text",[s("v-container",{attrs:{"grid-list-md":""}},[s("v-layout",{attrs:{wrap:""}},[s("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[s("v-text-field",{attrs:{label:"角色名称"},model:{value:e.editedItem.roleName,callback:function(t){e.$set(e.editedItem,"roleName",t)},expression:"editedItem.roleName"}})],1),e._v(" "),s("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[s("v-text-field",{attrs:{label:"角色描述"},model:{value:e.editedItem.roleDescribe,callback:function(t){e.$set(e.editedItem,"roleDescribe",t)},expression:"editedItem.roleDescribe"}})],1)],1)],1)],1),e._v(" "),s("v-card-actions",[s("v-spacer"),e._v(" "),s("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(t){return e.close(t)}}},[e._v("取消")]),e._v(" "),s("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(t){return e.save(t)}}},[e._v("确定")])],1)],1)],1),e._v(" "),e.display?s("v-card",[s("v-card-title",[s("b",{staticStyle:{"font-size":"18px"}},[e._v("角色管理")]),e._v(" "),s("v-btn",{attrs:{icon:""},on:{click:e.addRole}},[s("v-icon",{attrs:{medium:""}},[e._v("add")])],1),e._v(" "),s("v-spacer"),e._v(" "),s("v-text-field",{attrs:{"append-icon":"search",label:"搜索","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),s("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.items,search:e.search,"rows-per-page-text":e.pageText,"rows-per-page-items":e.pageItems},scopedSlots:e._u([{key:"items",fn:function(t){return[s("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.roleName))]),e._v(" "),s("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.roleDescribe))]),e._v(" "),s("td",{staticClass:"justify-center layout px-0"},[s("v-btn",{staticClass:"mx-0",attrs:{icon:""},on:{click:function(s){e.editItem(t.item)}}},[s("v-icon",{attrs:{color:"teal"}},[e._v("edit")])],1),e._v(" "),s("v-btn",{staticClass:"mx-0",attrs:{icon:""},on:{click:function(s){e.deleteItem(t.item)}}},[s("v-icon",{attrs:{color:"pink"}},[e._v("delete")])],1)],1)]}}])},[s("v-alert",{attrs:{slot:"no-results",value:!0,color:"error",icon:"warning"},slot:"no-results"},[e._v("\n        没有查询到"+e._s(e.search)+"\n      ")])],1)],1):e._e()],1)},staticRenderFns:[]},w=s("VU/8")(k,y,!1,null,null,null).exports,I=s("Dd8w"),$=s.n(I),C=s("NYxO"),T={data:function(){return{authAlert:!1,display:!1,search:"",pageText:"每页显示行数",pageItems:[15,25,35,{text:"所有",value:-1}],headers:[{text:"书名",value:"name",align:"center"},{text:"分类",value:"category",align:"center"},{text:"库存",value:"stock",align:"center"},{text:"在库",value:"left",align:"center"},{text:"出版时间",value:"publishTime",align:"center"},{text:"价格",value:"price",align:"center"},{text:"操作",value:"operation",align:"center"}],items:[],editedIndex:-1,bookMenu:!1}},computed:$()({},Object(C.c)(["book"])),created:function(){var e=this;this.$http.get("/verify").then(function(t){"user"==t.data.user.role.roleName?(e.authAlert=!0,setTimeout(function(){e.authAlert=!1,e.$router.push("/main/bookDisplay")},2e3)):(e.display=!0,e.fetchData())}).catch(function(e){console.log(e)})},methods:$()({},Object(C.b)(["editBook"]),{fetchData:function(){var e=this;this.$http.get("/getBooks").then(function(t){e.items=t.data.books}).catch(function(e){console.log(e)})},deleteItem:function(e){var t=this,s=this.items.indexOf(e);confirm("确定要删除此图书吗？")&&this.$http.post("/deleteBook",{_id:e._id}).then(function(e){e.data.deleteBook&&t.items.splice(s,1)}).catch(function(e){console.log(e)})},addBook:function(){this.$store.commit("clearItem"),this.$router.push("bookDetailEdit")}})},D={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("v-alert",{attrs:{type:"error",transition:"scale-transition",dismissible:""},model:{value:e.authAlert,callback:function(t){e.authAlert=t},expression:"authAlert"}},[e._v("\n    权限不足，请联系超级管理员！！！\n  ")]),e._v(" "),e.display?s("v-card",[s("v-card-title",[s("b",{staticStyle:{"font-size":"18px"}},[e._v("图书管理")]),e._v(" "),s("v-btn",{attrs:{icon:""},on:{click:e.addBook}},[s("v-icon",{attrs:{medium:""}},[e._v("add")])],1),e._v(" "),s("v-spacer"),e._v(" "),s("v-text-field",{attrs:{"append-icon":"search",label:"搜索","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),s("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.items,search:e.search,"rows-per-page-text":e.pageText,"rows-per-page-items":e.pageItems},scopedSlots:e._u([{key:"items",fn:function(t){return[s("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.name))]),e._v(" "),s("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.category))]),e._v(" "),s("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.stock))]),e._v(" "),s("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.left))]),e._v(" "),s("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.publishTime))]),e._v(" "),s("td",{staticClass:"text-xs-center"},[e._v(e._s(t.item.price))]),e._v(" "),s("td",{staticClass:"justify-center layout px-0"},[s("v-btn",{staticClass:"mx-0",attrs:{icon:""},on:{click:function(s){e.editBook({editedItem:t.item,router:e.$router})}}},[s("v-icon",{attrs:{color:"teal"}},[e._v("edit")])],1),e._v(" "),s("v-btn",{staticClass:"mx-0",attrs:{icon:""},on:{click:function(s){e.deleteItem(t.item)}}},[s("v-icon",{attrs:{color:"pink"}},[e._v("delete")])],1)],1)]}}])},[s("v-alert",{attrs:{slot:"no-results",value:!0,color:"error",icon:"warning"},slot:"no-results"},[e._v("\n        没有查询到"+e._s(e.search)+"\n      ")])],1)],1):e._e()],1)},staticRenderFns:[]},A=s("VU/8")(T,D,!1,null,null,null).exports,M={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"test"}},[t("h1",[this._v("ellovu")])])}]},S=s("VU/8")({},M,!1,null,null,null).exports,B=s("KvPw"),R=s.n(B),P=(s("hCol"),s("3f40"),s("4qOc"),s("+cgv"),s("G0J2")),U={data:function(){return{authAlert:!1,display:!1,valid:!0,bookMenu:!1,saveBookValid:!0,loading:!1,dropzoneOptions:{paramName:"files",url:"/upload",thumbnailWidth:200,thumbnailHeight:200,timeout:6e5,maxFilesize:1e4,autoProcessQueue:!1,uploadMultiple:!0,parallelUploads:9,maxFiles:9,addRemoveLinks:!0,dictCancelUpload:"取消上传",dictCancelUploadConfirmation:"确定要取消上传吗？",dictRemoveFile:"移除",dictDefaultMessage:"<div text-align='center'><i class='fa fa-cloud-upload fa-3x'></i><br>拖拽上传</div>",headers:{"My-Awesome-Header":"header value"}},editorOption:{placeholder:"输入图书简介。。。",modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"]]}}}},components:{vueDropzone:R.a,quillEditor:P.quillEditor},created:function(){var e=this;this.$http.get("/verify").then(function(t){"user"==t.data.user.role.roleName?(e.authAlert=!0,setTimeout(function(){e.authAlert=!1,e.$router.push("/main/bookDisplay")},2e3)):e.display=!0}).catch(function(e){console.log(e)})},methods:{successUpload:function(e,t){var s=this;console.log(t),t.upload&&(this.book.images=t.images,this.book._id?this.$http.post("/updateBook",{_id:this.book._id,modifiedBook:this.book}).then(function(e){e.data.updateBook&&(s.loading=!1,s.valid=!0,s.clearBook())}).catch(function(e){console.log(e)}):this.$http.post("/addBook",this.book).then(function(e){e.data.addBook&&(s.loading=!1,s.valid=!0,s.clearBook())}).catch(function(e){console.log(e)}))},clearBook:function(){this.$refs.myVueDropzone.removeAllFiles(),this.$store.dispatch("clearBook")},saveBook:function(){this.loading=!0,this.valid=!1,this.$refs.myVueDropzone.processQueue()}},computed:$()({},Object(C.c)(["book"]))},F={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("v-alert",{attrs:{type:"error",transition:"scale-transition",dismissible:""},model:{value:e.authAlert,callback:function(t){e.authAlert=t},expression:"authAlert"}},[e._v("\n    权限不足，请联系超级管理员！！！\n  ")]),e._v(" "),e.display?s("v-card",[s("v-card-title"),e._v(" "),s("v-card-text",[s("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[s("v-container",{attrs:{"grid-list-md":"","text-xs-center":""}},[s("v-layout",{attrs:{wrap:""}},[s("v-flex",{attrs:{xs6:"",sm4:"",md3:""}},[s("v-text-field",{attrs:{label:"书名","prepend-icon":"book"},model:{value:e.book.name,callback:function(t){e.$set(e.book,"name",t)},expression:"book.name"}})],1),e._v(" "),s("v-flex",{attrs:{xs6:"",sm4:"",md3:""}},[s("v-text-field",{attrs:{label:"分类","prepend-icon":"class"},model:{value:e.book.category,callback:function(t){e.$set(e.book,"category",t)},expression:"book.category"}})],1),e._v(" "),s("v-flex",{attrs:{xs6:"",sm4:"",md3:""}},[s("v-text-field",{attrs:{label:"库存",type:"number","prepend-icon":"library_books"},model:{value:e.book.stock,callback:function(t){e.$set(e.book,"stock",t)},expression:"book.stock"}})],1),e._v(" "),s("v-flex",{attrs:{xs6:"",sm4:"",md3:""}},[s("v-text-field",{attrs:{label:"在库",type:"number","prepend-icon":"assignment_turned_in"},model:{value:e.book.left,callback:function(t){e.$set(e.book,"left",t)},expression:"book.left"}})],1),e._v(" "),s("v-flex",{attrs:{xs6:"",sm4:"",md3:""}},[s("v-menu",{ref:"BookMenu",attrs:{lazy:"","close-on-content-click":!1,transition:"scale-transition","offset-y":"","full-width":"","return-value":e.book.publishTime},on:{"update:returnValue":function(t){e.$set(e.book,"publishTime",t)}},model:{value:e.bookMenu,callback:function(t){e.bookMenu=t},expression:"bookMenu"}},[s("v-text-field",{attrs:{slot:"activator",label:"出版时间","prepend-icon":"event",readonly:""},slot:"activator",model:{value:e.book.publishTime,callback:function(t){e.$set(e.book,"publishTime",t)},expression:"book.publishTime"}}),e._v(" "),s("v-date-picker",{attrs:{"no-title":"",scrollable:"",locale:"zh-cn"},model:{value:e.book.publishTime,callback:function(t){e.$set(e.book,"publishTime",t)},expression:"book.publishTime"}},[s("v-spacer"),e._v(" "),s("v-btn",{attrs:{flat:"",color:"primary"},on:{click:function(t){e.beginMenu=!1}}},[e._v("取消")]),e._v(" "),s("v-btn",{attrs:{flat:"",color:"primary"},on:{click:function(t){e.$refs.BookMenu.save(e.book.publishTime)}}},[e._v("确定")])],1)],1)],1),e._v(" "),s("v-flex",{attrs:{xs6:"",sm4:"",md3:""}},[s("v-text-field",{attrs:{label:"价格","prepend-icon":"¥"},model:{value:e.book.price,callback:function(t){e.$set(e.book,"price",t)},expression:"book.price"}})],1),e._v(" "),s("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[s("v-subheader",{staticStyle:{"font-size":"16px"}},[e._v("图片简介：")]),e._v(" "),s("vue-dropzone",{ref:"myVueDropzone",attrs:{id:"dropzone",name:"files",options:e.dropzoneOptions},on:{"vdropzone-success-multiple":e.successUpload}})],1),e._v(" "),s("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[s("v-subheader",{staticStyle:{"font-size":"16px"}},[e._v("内容介绍：")]),e._v(" "),s("quill-editor",{ref:"myQuillEditor",attrs:{options:e.editorOption},model:{value:e.book.content,callback:function(t){e.$set(e.book,"content",t)},expression:"book.content"}})],1),e._v(" "),s("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[s("v-btn",{staticClass:"warning",on:{click:e.clearBook}},[e._v("清除")]),e._v(" "),s("v-btn",{staticClass:"success",attrs:{disabled:!e.saveBookValid,loading:e.loading},on:{click:e.saveBook}},[e._v("登记")])],1)],1)],1)],1)],1)],1):e._e()],1)},staticRenderFns:[]};var z=s("VU/8")(U,F,!1,function(e){s("dvsz")},null,null).exports,V={data:function(){return{books:[],user:{},isSubscribe:""}},methods:{showBookDetail:function(e){this.$store.commit("showBookDetail",e),this.$router.push("/main/bookDisplay/"+e._id)},collect:function(e){var t=this;e.isCollect?this.$http.post("/removeCollect",{_id:e._id,collectors:e.collectors}).then(function(s){if(s.data.removeCollect){for(var o=-1,r=0;r<e.collectors.length;r++)if(e.collectors[r].username==t.user.username){o=r;break}console.log("removeIndex: ",o),e.collectors.splice(o,1),e.isCollect=!1}}).catch(function(e){console.log(e)}):this.$http.post("/collect",{_id:e._id,collectors:e.collectors}).then(function(s){s.data.collect&&(e.collectors.push({username:t.user.username}),t.$set(e,"isCollect",!0))}).catch(function(e){console.log(e)})},subscribe:function(e){var t=this;e.isSubscribe?this.$http.post("/removeSubscribe",{_id:e._id,subscribers:e.subscribers}).then(function(s){if(s.data.removeSubscribe){for(var o=-1,r=0;r<e.collectors.length;r++)if(e.subscribers[r].username==t.user.username){o=r;break}console.log("removeIndex: ",o),e.subscribers.splice(o,1),e.isSubscribe=!1}}).catch(function(e){console.log(e)}):this.$http.post("/subscribe",{_id:e._id,subscribers:e.subscribers}).then(function(s){s.data.subscribe&&(e.subscribers.push({username:t.user.username}),t.$set(e,"isSubscribe",!0))}).catch(function(e){console.log(e)})},collectColor:function(e){return e.isCollect?"red":"red lighten-4"},subscribeColor:function(e){return e.isSubscribe?"orange":"orange lighten-4"},fetchData:function(){var e=this;this.$http.get("/getBooks").then(function(t){if(t.data.getBooks){e.books=t.data.books;for(var s=0;s<e.books.length;s++){for(var o=0;o<e.books[s].collectors.length;o++){if(e.books[s].collectors[o].username==e.user.username){e.books[s].isCollect=!0;break}e.books[s].isCollect=!1}for(var r=0;r<e.books[s].subscribers.length;r++){if(e.books[s].subscribers[r].username==e.user.username){e.books[s].isSubscribe=!0;break}e.books[s].isSubscribe=!1}}}}).catch(function(e){console.log(e)})},removeHTMLTag:function(e){return e=(e=(e=(e=(e=e.replace(/<\/?[^>]*>/g,"")).replace(/[ | ]*\n/g,"\n")).replace(/\n[\s| | ]*\r/g,"\n")).replace(/&nbsp;/gi,"")).replace(/\s/g,"")}},computed:{},created:function(){var e=this;this.$http.get("/verify").then(function(t){e.user=t.data.user}).catch(function(e){console.log(e)})},mounted:function(){this.fetchData()}},N={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-container",{attrs:{fluid:"","grid-list-md":"","text-xs-center":""}},[s("v-layout",{attrs:{row:"",wrap:""}},e._l(e.books,function(t,o){return s("v-flex",{key:o,attrs:{xs12:"",sm6:"",md4:"",lg3:""}},[s("v-card",{attrs:{height:"330px",tile:""}},[s("div",{on:{click:function(s){e.showBookDetail(t)}}},[s("v-card-media",{staticClass:"white--text",attrs:{height:"160px",src:t.images[0].src}},[s("v-container",{attrs:{"fill-height":"",fluid:""}},[s("v-layout",{attrs:{"fill-height":""}},[s("v-flex",{attrs:{xs12:"","align-end":"",flexbox:""}},[s("span",{staticClass:"headline"},[e._v(e._s(t.name))])])],1)],1)],1),e._v(" "),s("v-card-title",[s("div",[e._v("\n              "+e._s(e.removeHTMLTag(t.content).length>=55?e.removeHTMLTag(t.content).substr(0,55)+"......":e.removeHTMLTag(t.content))+"\n            ")])])],1),e._v(" "),s("v-card-actions",[s("v-container",{attrs:{"grid-list-md":"","text-xs-center":""}},[s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",[s("v-btn",{attrs:{small:"",flat:"",color:e.collectColor(t)},on:{click:function(s){e.collect(t)}}},[s("v-icon",[e._v("favorite")]),e._v("收藏"+e._s(t.collectors.length>0?t.collectors.length:""))],1)],1),e._v(" "),s("v-flex",[s("v-btn",{attrs:{small:"",flat:"",color:e.subscribeColor(t)},on:{click:function(s){e.subscribe(t)}}},[s("v-icon",[e._v("star")]),e._v("订阅"+e._s(t.subscribers.length>0?t.subscribers.length:""))],1)],1)],1)],1)],1)],1)],1)}))],1)},staticRenderFns:[]};var O=s("VU/8")(V,N,!1,function(e){s("RmRg")},null,null).exports,E=s("T2eB"),H={data:function(){return{tabs:["详情","评价","推荐"],tabItem:"tab-详情"}},components:{Carousel3d:E.Carousel3d,Slide:E.Slide},computed:$()({},Object(C.c)(["book"]),{carouselDisplay:{get:function(){return this.book.images.length%2==0?this.book.images.length-1:this.book.images.length}}})},L={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-card",[s("v-card-text",[s("v-container",{attrs:{fluid:"","text-xs-center":""}},[s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",{attrs:{xs12:""}},[s("h2",[e._v(e._s(e.book.name))]),e._v(" "),s("span",[s("v-chip",{attrs:{small:"",label:"",outline:"",color:"red"}},[e._v(e._s(e.book.category))]),e._v(" "),s("v-chip",{attrs:{small:"",label:"",outline:"",color:"green"}},[e._v("价格:"+e._s(e.book.price))]),e._v(" "),s("v-chip",{attrs:{small:"",label:"",outline:"",color:"pink"}},[e._v("库存:"+e._s(e.book.stock))]),e._v(" "),s("v-chip",{attrs:{small:"",label:"",outline:"",color:"blue"}},[e._v("在库:"+e._s(e.book.left))]),e._v(" "),s("v-chip",{attrs:{small:"",label:"",outline:"",color:"cyan"}},[e._v("发布时间:"+e._s(e.book.publishTime))])],1),e._v(" "),s("carousel-3d",{attrs:{height:200,autoplay:!0,"autoplay-timeout":2e3,display:e.carouselDisplay,border:0,perspective:35,inverseScaling:100}},e._l(e.book.images,function(e,t){return s("slide",{key:t,attrs:{index:t}},[s("img",{attrs:{src:e.src}})])}))],1)],1)],1),e._v(" "),s("v-divider"),e._v(" "),s("v-tabs",{model:{value:e.tabItem,callback:function(t){e.tabItem=t},expression:"tabItem"}},e._l(e.tabs,function(t,o){return s("v-tab",{key:o,attrs:{href:"#tab-"+t}},[e._v("\n        "+e._s(t)+"\n      ")])})),e._v(" "),s("v-divider"),e._v(" "),s("v-tabs-items",{model:{value:e.tabItem,callback:function(t){e.tabItem=t},expression:"tabItem"}},[s("v-tab-item",{attrs:{id:"tab-详情"}},[s("v-card-text",{domProps:{innerHTML:e._s(e.book.content)}}),e._v(" "),s("v-container",{attrs:{"grid-list-md":"","text-xs-center":""}},[s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",[s("v-btn",{attrs:{small:"",flat:"",color:"red lighten-4"}},[s("v-icon",[e._v("favorite")]),e._v("收藏")],1)],1),e._v(" "),s("v-flex",[s("v-btn",{attrs:{small:"",flat:"",color:"orange lighten-4"}},[s("v-icon",[e._v("star")]),e._v("订阅")],1)],1)],1)],1)],1),e._v(" "),s("v-tab-item",{attrs:{id:"tab-评价"}},[s("v-card-text",[s("h1",[e._v("😊😀😃😄😁😆😅😂🤣☺️😊😇🙂🙃😉😌😍😘😗😙😚😋😛😝😜🤪🤨🧐")]),e._v(" "),s("h1",[e._v("😊😋😛😝😜🤪敬请期待😊😋😛😝😜🤪")]),e._v(" "),s("h1",[e._v("😊😀😃😄😁😆😅😂🤣☺️😊😇🙂🙃😉😌😍😘😗😙😚😋😛😝😜🤪🤨🧐")])])],1),e._v(" "),s("v-tab-item",{attrs:{id:"tab-推荐"}},[s("v-card-text",[s("h1",[e._v("😊😀😃😄😁😆😅😂🤣☺️😊😇🙂🙃😉😌😍😘😗😙😚😋😛😝😜🤪🤨🧐")]),e._v(" "),s("h1",[e._v("😊😋😛😝😜🤪敬请期待😊😋😛😝😜🤪")]),e._v(" "),s("h1",[e._v("😊😀😃😄😁😆😅😂🤣☺️😊😇🙂🙃😉😌😍😘😗😙😚😋😛😝😜🤪🤨🧐")])])],1)],1)],1)],1)},staticRenderFns:[]},j=s("VU/8")(H,L,!1,null,null,null).exports,q={data:function(){return{books:[],user:{},isSubscribe:""}},methods:{showBookDetail:function(e){this.$store.commit("showBookDetail",e),this.$router.push("/main/bookDisplay/"+e._id)},collect:function(e){var t=this;e.isCollect?this.$http.post("/removeCollect",{_id:e._id,collectors:e.collectors}).then(function(s){if(s.data.removeCollect){for(var o=-1,r=0;r<e.collectors.length;r++)if(e.collectors[r].username==t.user.username){o=r;break}console.log("removeIndex: ",o),e.collectors.splice(o,1),e.isCollect=!1}}).catch(function(e){console.log(e)}):this.$http.post("/collect",{_id:e._id,collectors:e.collectors}).then(function(s){s.data.collect&&(e.collectors.push({username:t.user.username}),t.$set(e,"isCollect",!0))}).catch(function(e){console.log(e)})},subscribe:function(e){var t=this;e.isSubscribe?this.$http.post("/removeSubscribe",{_id:e._id,subscribers:e.subscribers}).then(function(s){if(s.data.removeSubscribe){for(var o=-1,r=0;r<e.collectors.length;r++)if(e.subscribers[r].username==t.user.username){o=r;break}console.log("removeIndex: ",o),e.subscribers.splice(o,1),e.isSubscribe=!1}}).catch(function(e){console.log(e)}):this.$http.post("/subscribe",{_id:e._id,subscribers:e.subscribers}).then(function(s){s.data.subscribe&&(e.subscribers.push({username:t.user.username}),t.$set(e,"isSubscribe",!0))}).catch(function(e){console.log(e)})},collectColor:function(e){return e.isCollect?"red":"red lighten-4"},subscribeColor:function(e){return e.isSubscribe?"orange":"orange lighten-4"},fetchData:function(){var e=this;this.$http.get("/getBooks").then(function(t){if(t.data.getBooks){e.books=t.data.books;for(var s=0;s<e.books.length;s++){for(var o=0;o<e.books[s].collectors.length;o++){if(e.books[s].collectors[o].username==e.user.username){e.books[s].isCollect=!0;break}e.books[s].isCollect=!1}for(var r=0;r<e.books[s].subscribers.length;r++){if(e.books[s].subscribers[r].username==e.user.username){e.books[s].isSubscribe=!0;break}e.books[s].isSubscribe=!1}}}}).catch(function(e){console.log(e)})},removeHTMLTag:function(e){return e=(e=(e=(e=(e=e.replace(/<\/?[^>]*>/g,"")).replace(/[ | ]*\n/g,"\n")).replace(/\n[\s| | ]*\r/g,"\n")).replace(/&nbsp;/gi,"")).replace(/\s/g,"")}},computed:{},created:function(){var e=this;this.$http.get("/verify").then(function(t){e.user=t.data.user}).catch(function(e){console.log(e)})},mounted:function(){this.fetchData()}},Q={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-container",{attrs:{fluid:"","grid-list-md":"","text-xs-center":""}},[s("v-layout",{attrs:{row:"",wrap:""}},e._l(e.books,function(t,o){return t.isCollect?s("v-flex",{key:o,attrs:{xs12:"",sm6:"",md4:"",lg3:""}},[s("v-card",{attrs:{height:"330px",tile:""}},[s("div",{on:{click:function(s){e.showBookDetail(t)}}},[s("v-card-media",{staticClass:"white--text",attrs:{height:"160px",src:t.images[0].src}},[s("v-container",{attrs:{"fill-height":"",fluid:""}},[s("v-layout",{attrs:{"fill-height":""}},[s("v-flex",{attrs:{xs12:"","align-end":"",flexbox:""}},[s("span",{staticClass:"headline"},[e._v(e._s(t.name))])])],1)],1)],1),e._v(" "),s("v-card-title",[s("div",[e._v("\n              "+e._s(e.removeHTMLTag(t.content).length>=55?e.removeHTMLTag(t.content).substr(0,55)+"......":e.removeHTMLTag(t.content))+"\n            ")])])],1),e._v(" "),s("v-card-actions",[s("v-container",{attrs:{"grid-list-md":"","text-xs-center":""}},[s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",[s("v-btn",{attrs:{small:"",flat:"",color:e.collectColor(t)},on:{click:function(s){e.collect(t)}}},[s("v-icon",[e._v("favorite")]),e._v("收藏"+e._s(t.collectors.length>0?t.collectors.length:""))],1)],1),e._v(" "),s("v-flex",[s("v-btn",{attrs:{small:"",flat:"",color:e.subscribeColor(t)},on:{click:function(s){e.subscribe(t)}}},[s("v-icon",[e._v("star")]),e._v("订阅"+e._s(t.subscribers.length>0?t.subscribers.length:""))],1)],1)],1)],1)],1)],1)],1):e._e()}))],1)},staticRenderFns:[]};var W=s("VU/8")(q,Q,!1,function(e){s("umsT")},null,null).exports,J={data:function(){return{books:[],user:{},isSubscribe:""}},methods:{showBookDetail:function(e){this.$store.commit("showBookDetail",e),this.$router.push("/main/bookDisplay/"+e._id)},collect:function(e){var t=this;e.isCollect?this.$http.post("/removeCollect",{_id:e._id,collectors:e.collectors}).then(function(s){if(s.data.removeCollect){for(var o=-1,r=0;r<e.collectors.length;r++)if(e.collectors[r].username==t.user.username){o=r;break}console.log("removeIndex: ",o),e.collectors.splice(o,1),e.isCollect=!1}}).catch(function(e){console.log(e)}):this.$http.post("/collect",{_id:e._id,collectors:e.collectors}).then(function(s){s.data.collect&&(e.collectors.push({username:t.user.username}),t.$set(e,"isCollect",!0))}).catch(function(e){console.log(e)})},subscribe:function(e){var t=this;e.isSubscribe?this.$http.post("/removeSubscribe",{_id:e._id,subscribers:e.subscribers}).then(function(s){if(s.data.removeSubscribe){for(var o=-1,r=0;r<e.collectors.length;r++)if(e.subscribers[r].username==t.user.username){o=r;break}console.log("removeIndex: ",o),e.subscribers.splice(o,1),e.isSubscribe=!1}}).catch(function(e){console.log(e)}):this.$http.post("/subscribe",{_id:e._id,subscribers:e.subscribers}).then(function(s){s.data.subscribe&&(e.subscribers.push({username:t.user.username}),t.$set(e,"isSubscribe",!0))}).catch(function(e){console.log(e)})},collectColor:function(e){return e.isCollect?"red":"red lighten-4"},subscribeColor:function(e){return e.isSubscribe?"orange":"orange lighten-4"},fetchData:function(){var e=this;this.$http.get("/getBooks").then(function(t){if(t.data.getBooks){e.books=t.data.books;for(var s=0;s<e.books.length;s++){for(var o=0;o<e.books[s].collectors.length;o++){if(e.books[s].collectors[o].username==e.user.username){e.books[s].isCollect=!0;break}e.books[s].isCollect=!1}for(var r=0;r<e.books[s].subscribers.length;r++){if(e.books[s].subscribers[r].username==e.user.username){e.books[s].isSubscribe=!0;break}e.books[s].isSubscribe=!1}}}}).catch(function(e){console.log(e)})},removeHTMLTag:function(e){return e=(e=(e=(e=(e=e.replace(/<\/?[^>]*>/g,"")).replace(/[ | ]*\n/g,"\n")).replace(/\n[\s| | ]*\r/g,"\n")).replace(/&nbsp;/gi,"")).replace(/\s/g,"")}},computed:{},created:function(){var e=this;this.$http.get("/verify").then(function(t){e.user=t.data.user}).catch(function(e){console.log(e)})},mounted:function(){this.fetchData()}},G={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-container",{attrs:{fluid:"","grid-list-md":"","text-xs-center":""}},[s("v-layout",{attrs:{row:"",wrap:""}},e._l(e.books,function(t,o){return t.isSubscribe?s("v-flex",{key:o,attrs:{xs12:"",sm6:"",md4:"",lg3:""}},[s("v-card",{attrs:{height:"330px",tile:""}},[s("div",{on:{click:function(s){e.showBookDetail(t)}}},[s("v-card-media",{staticClass:"white--text",attrs:{height:"160px",src:t.images[0].src}},[s("v-container",{attrs:{"fill-height":"",fluid:""}},[s("v-layout",{attrs:{"fill-height":""}},[s("v-flex",{attrs:{xs12:"","align-end":"",flexbox:""}},[s("span",{staticClass:"headline"},[e._v(e._s(t.name))])])],1)],1)],1),e._v(" "),s("v-card-title",[s("div",[e._v("\n              "+e._s(e.removeHTMLTag(t.content).length>=55?e.removeHTMLTag(t.content).substr(0,55)+"......":e.removeHTMLTag(t.content))+"\n            ")])])],1),e._v(" "),s("v-card-actions",[s("v-container",{attrs:{"grid-list-md":"","text-xs-center":""}},[s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",[s("v-btn",{attrs:{small:"",flat:"",color:e.collectColor(t)},on:{click:function(s){e.collect(t)}}},[s("v-icon",[e._v("favorite")]),e._v("收藏"+e._s(t.collectors.length>0?t.collectors.length:""))],1)],1),e._v(" "),s("v-flex",[s("v-btn",{attrs:{small:"",flat:"",color:e.subscribeColor(t)},on:{click:function(s){e.subscribe(t)}}},[s("v-icon",[e._v("star")]),e._v("订阅"+e._s(t.subscribers.length>0?t.subscribers.length:""))],1)],1)],1)],1)],1)],1)],1):e._e()}))],1)},staticRenderFns:[]};var K=s("VU/8")(J,G,!1,function(e){s("gNu7")},null,null).exports;o.a.use(n.a);var Y=new n.a({routes:[{path:"/",name:"登录",component:v},{path:"/register",name:"注册",component:f},{path:"/outTest",name:"测试页",component:S},{path:"/main",name:"主页",component:c,children:[{path:"inTest",name:"内部测试页",component:S},{path:"users",name:"用户管理",component:x},{path:"roles",name:"角色管理",component:w},{path:"bookManage",name:"图书管理",component:A},{path:"bookDetailEdit",name:"图书详细编辑",component:z},{path:"bookDisplay",name:"图书一览",component:O},{path:"bookDisplay/:id",name:"图书详情",component:j},{path:"myCollectBooks",name:"我的收藏",component:W},{path:"mySubscribeBooks",name:"我的订阅",component:K}]},{path:"*",redirect:"/"}]}),X=s("3EgV"),Z=s.n(X),ee=s("mtWM"),te=s.n(ee),se={state:{book:{name:"",category:"",stock:"",left:"",publishTime:"",price:"",content:"",images:[],collectors:[],subscribers:[]}},getters:{book:function(e){return e.book}},actions:{editBook:function(e,t){var s=e.commit,o=t.editedItem,r=t.router;s("editItem",o),r.push("bookDetailEdit")},clearBook:function(e){(0,e.commit)("clearItem")},showBookDetail:function(e,t){(0,e.commit)("showBookDetail",t)}},mutations:{editItem:function(e,t){e.book=t},clearItem:function(e){e.book={name:"",category:"",stock:"",left:"",publishTime:"",price:"",content:"",images:[],collectors:[],subscribers:[]}},showBookDetail:function(e,t){e.book=t}}};o.a.use(C.a);var oe=new C.a.Store({modules:{book:se}});s("7zck");o.a.prototype.$http=te.a,o.a.use(Z.a,{theme:{primary:"#ee44aa",secondary:"#424242",accent:"#82B1FF",error:"#FF5252",info:"#2196F3",success:"#4CAF50",warning:"#FFC107"}}),o.a.config.productionTip=!1,new o.a({el:"#app",router:Y,store:oe,components:{App:i},template:"<App/>"})},RmRg:function(e,t){},dvsz:function(e,t){},gNu7:function(e,t){},hCol:function(e,t){},umsT:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.0c6e2e5556e21f81fa9b.js.map